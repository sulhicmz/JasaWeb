---
// src/pages/portfolio/[slug].astro
import Layout from '../../layouts/Layout.astro';
import { getCollection, type CollectionEntry } from 'astro:content';

export const prerender = true;

export async function getStaticPaths() {
  const projects = await getCollection('portfolio');
  return projects.map((project) => ({
    params: { slug: project.slug },
    props: { project },
  }));
}

interface Props {
  project: CollectionEntry<'portfolio'>;
}

const { project } = Astro.props;
---

<Layout title={project.data.title}>
  <article class="py-12 bg-white">
    <div class="container mx-auto px-4 max-w-4xl">
      <header class="mb-8 text-center">
        <h1 class="text-3xl md:text-4xl font-bold mb-4">{project.data.title}</h1>
        <div class="flex items-center justify-center space-x-4 text-gray-600 mb-6">
          <span>{project.data.client}</span>
          <span>â€¢</span>
          <time datetime={project.data.date.toISOString()}>
            {project.data.date.toLocaleDateString('id-ID', { 
              year: 'numeric', 
              month: 'long', 
              day: 'numeric' 
            })}
          </time>
        </div>
        <span class={`inline-block ${
          project.data.category.includes('Sekolah') ? 'bg-blue-100 text-blue-800' :
          project.data.category.includes('Berita') ? 'bg-green-100 text-green-800' :
          project.data.category.includes('Company') ? 'bg-purple-100 text-purple-800' :
          project.data.category.includes('E-Learning') ? 'bg-yellow-100 text-yellow-800' :
          project.data.category.includes('Wisata') ? 'bg-red-100 text-red-800' :
          'bg-indigo-100 text-indigo-800'
        } text-sm px-3 py-1 rounded-full mb-4`}>
          {project.data.category}
        </span>
        {project.data.tags && (
          <div class="flex flex-wrap justify-center gap-2">
            {project.data.tags.map((tag) => (
              <span class="bg-gray-100 text-gray-800 text-sm px-3 py-1 rounded-full">
                #{tag}
              </span>
            ))}
          </div>
        )}
      </header>
      
      {project.data.image && (
        <div class="mb-8 rounded-lg overflow-hidden">
          <img src={project.data.image} alt={project.data.title} class="w-full h-auto" />
        </div>
      )}
      
      <div class="prose prose-lg max-w-none mb-12">
        <!-- The content will be rendered here -->
        <slot />
      </div>
      
      {project.data.url && (
        <div class="mb-12 text-center">
          <a 
            href={project.data.url} 
            target="_blank" 
            rel="noopener noreferrer"
            class="inline-block bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition duration-300"
          >
            Kunjungi Situs <i class="fas fa-external-link-alt ml-2"></i>
          </a>
        </div>
      )}
      
      <footer class="mt-12 pt-8 border-t border-gray-200">
        <div class="flex items-center justify-between">
          <a href="/portfolio" class="text-blue-600 hover:text-blue-800 flex items-center">
            <i class="fas fa-arrow-left mr-2"></i> Kembali ke Portofolio
          </a>
          <div class="flex space-x-4">
            <a href="#" class="text-gray-600 hover:text-blue-600">
              <i class="fab fa-facebook-f"></i>
            </a>
            <a href="#" class="text-gray-600 hover:text-blue-600">
              <i class="fab fa-twitter"></i>
            </a>
            <a href="#" class="text-gray-600 hover:text-blue-600">
              <i class="fab fa-linkedin-in"></i>
            </a>
          </div>
        </div>
      </footer>
    </div>
  </article>
</Layout>