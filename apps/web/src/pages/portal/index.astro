---
// src/pages/portal/index.astro
import Layout from '../../layouts/Layout.astro';
import DashboardHeader from '../../components/portal/DashboardHeader.astro';
import QuickActions from '../../components/portal/QuickActions.tsx';
import StatusWidgets from '../../components/portal/StatusWidgets.tsx';
import ProjectOverview from '../../components/portal/ProjectOverview.tsx';
import ActivityFeed from '../../components/portal/ActivityFeed.tsx';

export interface Props {
  title?: string;
}

const { title } = Astro.props;
---

<Layout title="Client Portal Dashboard">
  <div class="min-h-screen bg-gray-50">
    <DashboardHeader />
    
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <!-- Page Header -->
      <div class="mb-8">
        <h1 class="text-3xl font-bold text-gray-900">Dashboard</h1>
        <p class="mt-2 text-gray-600">Overview of your projects and activities</p>
      </div>

      <!-- Quick Actions -->
      <QuickActions client:load />

      <!-- Status Widgets Row -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <StatusWidgets client:load />
      </div>

      <!-- Main Content Grid -->
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Project Overview (2/3 width) -->
        <div class="lg:col-span-2">
          <ProjectOverview client:load />
        </div>

        <!-- Activity Feed (1/3 width) -->
        <div class="lg:col-span-1">
          <ActivityFeed client:load />
        </div>
      </div>
    </div>
  </div>

  <!-- Authentication Check Script -->
  <script client:load>
    // Check if user is authenticated
    const isAuthenticated = localStorage.getItem('authToken');
    if (!isAuthenticated) {
      // Redirect to login page if not authenticated
      window.location.href = '/login?redirect=' + encodeURIComponent(window.location.pathname);
    }
  </script>
</Layout>