---
// ScrollToTop.astro - Smooth scroll to top component (Enhanced)
---

<script is:inline>
  // Show/hide scroll-to-top button based on scroll position
  function handleScroll() {
    const scrollButton = document.getElementById('scroll-to-top');
    if (scrollButton) {
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      
      if (scrollTop > 300) {
        scrollButton.classList.remove('opacity-0', 'pointer-events-none');
        scrollButton.classList.add('opacity-100');
      } else {
        scrollButton.classList.add('opacity-0', 'pointer-events-none');
        scrollButton.classList.remove('opacity-100');
      }
    }
  }

  // Smooth scroll to top function (accessible globally)
  window.scrollToTop = function() {
    window.scrollTo({
      top: 0,
      behavior: 'smooth'
    });
  };

  // Handle route changes
  function handleRouteChange() {
    setTimeout(() => {
      if (window.scrollToTop) {
        window.scrollToTop();
      }
    }, 100);
  }

  // Initialize when DOM is ready
  function initializeScrollToTop() {
    // Initial check
    handleScroll();

    // Listen for scroll events
    window.addEventListener('scroll', handleScroll, { passive: true });

    // Listen for navigation changes
    window.addEventListener('popstate', handleRouteChange);
  }

  // Initialize on page load
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initializeScrollToTop);
  } else {
    initializeScrollToTop();
  }

  // Handle page navigation (for SPA-like behavior)
  window.addEventListener('astro:page-load', handleRouteChange);
</script>

<!-- Scroll to Top Button -->
<button
  id="scroll-to-top"
  class="fixed bottom-8 right-8 z-50 p-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-full shadow-lg shadow-blue-500/25 hover:shadow-blue-500/40 hover:scale-110 transition-all duration-300 opacity-0 pointer-events-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-slate-950"
  aria-label="Scroll to top"
  onclick="window.scrollToTop()"
>
  <i class="fas fa-arrow-up text-sm"></i>
</button>